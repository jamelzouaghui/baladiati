{% extends 'template.html.twig' %}
{% block headTile %}

    <ol class="breadcrumb">
        <li>
            {# <button type="button" class="btn btn-block btn-success" >Ajouter article </button>#}
            <a href="{{path('add-article')}}"  class="btn btn-block btn-success"> Ajouter article</a>
        </li>


    </ol>
{% endblock %}
{% block body %}

    {% for article in articles%}
        <div class="attachment-block clearfix">
            {%if article.photo is empty %}
                <img src="{{ asset('uploads/users/avatar.jpg' ) }}" class="attachment-img" alt="User " >

            {%else%}
                <img src="{{ asset('uploads/articles/' ~ article.photo) }}" class="attachment-img" alt="User Image" >
            {%endif%}

            <div class="attachment-pushed">
                <h4 class="attachment-heading"><a href="#">{{article.title}}</a></h4>

                <div class="attachment-text">
                    {{article.content}} <a href="#">more</a>
                </div>
                <div class="checkbox">
                    <label>
                        {%if article.publicated == 1%}
                            <input type="checkbox" onchange='handleChange(this,{{article.id}} );' checked> publié
                        {%else%}
                            <input type="checkbox" onchange='handleChange(this,{{article.id}} );' > publié
                        {%endif%}

                    </label>
                </div>

              {#  <a href="#" class="btn btn-social-icon btn-dropbox"><i class="fa fa-edit"></i>editer</a>
                <a href="#" class="btn btn-social-icon btn-dropbox"><i class="fa fa-times"></i>supprimer</a>#}
              <td>
                    <a  href="{{path('edit-article',{'id':article.id})}}" type="button" class="btn btn-block btn-info btn-xs">Modifier</a>
                    <a href="{{path('delete-article',{'id':article.id})}}"type="button" class="btn btn-block btn-danger btn-xs">Supprimer</a>
                  </td>

                <!-- /.attachment-text -->
            </div>
            <!-- /.attachment-pushed -->

        </div>

        <hr style="border-top: 1px solid #e0cacade;">
    {%endfor%}

    <script>
    
        function handleChange(checkbox, id) {
          
            if (checkbox.checked == true) {
                $.ajax({
                    type: "POST",
                    url: Routing.generate('publie-article', {'id': id}),
                    data: JSON.stringify({id: id}),
                    dataType: "json",
                    success: function (data) {
                        // Execute some specific data for route1
                    }
                });
            } else {
                $.ajax({
                    type: "POST",
                    url: Routing.generate('depublie-article', {'id': id}),
                    data: JSON.stringify({id: id}),
                    dataType: "json",
                    success: function (data) {
                    }
                });
            }
        }
    </script>


{% endblock %}